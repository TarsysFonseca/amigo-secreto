<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Amigo Secreto da Fam√≠lia 2025</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0; padding: 0;
    background: #fafafa;
    color: #222;
  }

  header {
    background: #198754;
    padding: 20px;
    color: #fff;
    text-align: center;
  }

  nav {
    background: #146c43;
    padding: 10px;
    text-align: center;
  }

  nav a {
    color: white;
    margin: 0 15px;
    text-decoration: none;
    font-weight: bold;
  }

  section {
    padding: 30px 20px;
    max-width: 900px;
    margin: auto;
  }

  input, button {
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 15px;
  }

  button {
    background: #198754;
    color: white;
    border: none;
    cursor: pointer;
  }

  table { width: 100%; border-collapse: collapse; margin-top: 15px; }
  th, td { padding: 10px; border-bottom: 1px solid #ddd; }
  th { background: #f3f3f3; }

  tr:hover { background: #f9f9f9; }

  .hidden { display: none; }

  /* Cards de Presentes */
  .cards-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
  }

  .card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .card:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 16px rgba(0,0,0,0.15);
  }

  .card-name {
    font-size: 18px;
    font-weight: bold;
    color: #198754;
    margin-bottom: 12px;
    border-bottom: 2px solid #198754;
    padding-bottom: 8px;
  }

  .card-suggestion {
    color: #444;
    line-height: 1.6;
    word-wrap: break-word;
  }

  .card-suggestion a {
    color: #0d6efd;
    text-decoration: none;
    font-weight: 500;
  }

  .card-suggestion a:hover {
    text-decoration: underline;
  }
</style>
</head>

<body>

<header>
  <h1>üéâ Amigo Secreto da Fam√≠lia 2025 üéÅ</h1>
</header>

<nav>
  <a href="#sorteio">Resultado</a>
  <a href="#presentes">Sugest√µes de Presentes</a>
</nav>


<!-- =======================
     SE√á√ÉO 1 ‚Äî RESULTADO
======================== -->

<section id="sorteio">
  <h2>üîê Consulte seu amigo secreto</h2>
  <p>Digite seu token para ver quem voc√™ tirou:</p>

  <input id="tokenInput" type="text" placeholder="Digite seu token">
  <button onclick="checkToken()">Consultar</button>

  <h3 id="result" style="margin-top:20px;"></h3>
</section>


<script>
const resultados = {
 "A92T":"Marcos Paulo",
 "L3PA":"Cl√°udia",
 "BR25":"Nilza",
 "BB12":"L√∫cia",
 "CM88":"Barbara",
 "OS47":"Clausi",
 "MP90":"Paula",
 "FD22":"Pedro",
 "CL55":"Tarsys",
 "PD61":"Clarissa",
 "NZ73":"C√°ssia",
 "ML14":"F√°bio",
 "CS09":"Claudete",
 "FN31":"Os√©ias",
 "CA82":"Marcos Luiz",
 "FB37":"Bruna",
 "LC44":"Fernand√£o",
 "CT66":"Fernandinho",
 "CR51":"C√©lia Maria"
};

function checkToken() {
  const token = document.getElementById("tokenInput").value.trim().toUpperCase();

  if (resultados[token]) {
    document.getElementById("result").innerHTML =
      `üéÅ Seu amigo secreto √©: <strong>${resultados[token]}</strong>`;
  } else {
    document.getElementById("result").innerHTML =
      "‚ùå Token inv√°lido. Verifique e tente novamente.";
  }
}

// Verifica se h√° um token na URL e executa automaticamente
window.addEventListener('DOMContentLoaded', () => {
  const urlParams = new URLSearchParams(window.location.search);
  const tokenFromUrl = urlParams.get('token');
  
  if (tokenFromUrl) {
    document.getElementById('tokenInput').value = tokenFromUrl;
    checkToken();
    // Scroll suave para a se√ß√£o de resultado
    document.getElementById('sorteio').scrollIntoView({ behavior: 'smooth' });
  }
});
</script>



<!-- =======================
     SE√á√ÉO 2 ‚Äî SUGEST√ïES
======================== -->

<section id="presentes">
  <h2>üéÅ Sugest√µes de Presentes</h2>
  <p>Veja o que j√° foi enviado pela fam√≠lia. Voc√™ tamb√©m pode enviar uma sugest√£o:</p>

  <a href="https://forms.gle/66DaEeY8cY3Pyc5D8"
     target="_blank"
     style="display:inline-block;margin:10px 0;padding:12px 20px;background:#198754;color:white;text-decoration:none;border-radius:6px;">
     ‚ûï Enviar nova sugest√£o
  </a>

  <h3 style="margin-top:30px;">üîç Buscar nome</h3>
  <input id="search" type="text" placeholder="Filtrar por nome...">

  <div id="count" style="margin:10px 0;color:#555;"></div>
  <div id="lista-presentes">Carregando sugest√µes‚Ä¶</div>
</section>



<!-- SCRIPT DA PLANILHA -->

<script>
async function loadSuggestions(){
  const sheetId = "1HZQljN2g5gNguZhnqnBU3hJj_VIfvcHrLjIi0atAF0E";
  const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;

  const res = await fetch(url);
  const text = await res.text();
  const json = JSON.parse(text.substring(47, text.length - 2));

  const rows = json.table.rows;
  const cols = json.table.cols.map(c => c.label);

  window.dataRows = rows.map(r => r.c.map(c => c?.v ?? ""));

  renderTable(window.dataRows, cols);
}

function renderTable(data, cols){
  let html = '<div class="cards-container">';

  data.forEach(row => {
    const nome = row[2] || "Sem nome";
    const s1 = row[3] || "Sem sugest√£o";
    const s2 = row[4] || "Sem sugest√£o";
    const s3 = row[5] || "Sem sugest√£o";

    
    // Converte URLs em links clic√°veis
    const s1ComLinks = linkify(s1);
    const s2ComLinks = linkify(s2);
    const s3ComLinks = linkify(s3);
    
    html += `
      <div class="card">
        <div class="card-name">üéÅ ${nome}</div>
        <div class="card-suggestion">${s1ComLinks}</div>
        <div class="card-suggestion">${s2ComLinks}</div>
        <div class="card-suggestion">${s3ComLinks}</div>
      </div>
    `;
  });

  html += "</div>";

  document.getElementById("lista-presentes").innerHTML = html;
  document.getElementById("count").innerText =
    `${data.length} sugest√£o(√µes) encontrada(s)`;
}

// Fun√ß√£o para converter URLs em links clic√°veis
function linkify(text) {
  const urlRegex = /(https?:\/\/[^\s]+)/g;
  return text.replace(urlRegex, '<a href="$1" target="_blank">$1</a>');
}

document.getElementById("search").addEventListener("input", e => {
  const q = e.target.value.toLowerCase();
  const filtered = window.dataRows.filter(r =>
    r.some(cell => String(cell).toLowerCase().includes(q))
  );

  renderTable(filtered, ["Nome", "Sugest√£o"]);
});

loadSuggestions();
</script>

</body>
</html>